{
  "default": {
    "environment":{
      "attempt_count": "1"
    }
  },
  "server": {
    "port": 88
  },
  "sequence": [
    ["for.session", [0, "${attempt_count}"], "i", [
        ["tcp.handshake"],
        ["sys.print", "krb5: ${RSGCLI_TCP_CLIENT_IP} -> ${RSGCLI_TCP_SERVER_IP}:${RSGCLI_TCP_SERVER_PORT}"],

        ["env.local.default", {
          "user_name_max16": "${rand.lower_alpha(8)}"
        }],
        
        ["", "## AS-REQ"],
        ["tcp.send", "multi", [
            ["hex.raw", [
                "00 00 00 c1",
                "6a 81 f0",
                "30 81 bb a1 03 02 01 05 a2 03 02 01 0a a3 15 30",
                "13 30 11 a1 04 02 02 00 80 a2 09 04 07 30 05 a0",
                "03 01 01 ff a4 81 97 30 81 94 a0 07 03 05 00 40",
                "81 00 10 a1 1e 30 1c a0 03 02 01 01 a1 15 30 13"
              ]
            ],
            ["", "## cname - Generalized String"],
            ["hex.raw", "1b"],
            ["hex.raw", "${user_name_max16=((17 - val.length()) + 128).hex_be(1)}"],
            ["hex.raw", "${user_name_max16=val.length().hex_be(${user_name_max16=17 - val.length()})}"],
            ["text.raw", "${user_name_max16}"],

            ["hex.raw", [
                "a2 11 1b 0f 63 6f 72 70 2e 63 6f 72 74 65 78 2e",
                "6c 61 6e a3 24 30 22 a0 03 02 01 02 a1 1b 30 19",
                "1b 06 6b 72 62 74 67 74 1b 0f 63 6f 72 70 2e 63",
                "6f 72 74 65 78 2e 6c 61 6e a5 11 18 0f"
              ]
            ],
            ["text.raw", "${time.utcnow()=(val + (60 * 60 * 24 * 365 * 10)).timestr(YYYYMMDDHHmmssZ)}"],
            ["hex.raw", [
                "a7 06 02 04 09 0a 33 4a a8 15 30 13 02 01 12 02",
                "01 11 02 01 17 02 01 18 02 02 ff 79 02 01 03"
              ]
            ]
          ]
        ],
        ["", "## KRB-ERR : KRB5KDC_ERR_PREAUTH_FAILED"],
        ["tcp.recv", "multi", [
            ["hex.raw", [
                "00 00 00 65 7e 63 30 61  a0 03 02 01 05 a1 03 02",
                "01 1e a4 11 18 0f"
              ]
            ],
            ["text.raw", "${time.utcnow()=val.timestr(YYYYMMDDHHmmssZ)}"],
            ["hex.raw", [
                "a5 04 02 02 7e bb a6 03  02 01 06 a9 11 1b 0f 63",
                "6f 72 70 2e 63 6f 72 74  65 78 2e 6c 61 6e aa 24",
                "30 22 a0 03 02 01 02 a1  1b 30 19 1b 06 6b 72 62",
                "74 67 74 1b 0f 63 6f 72  70 2e 63 6f 72 74 65 78",
                "2e 6c 61 6e"
              ]
            ]
          ]
        ],

        ["sys.time.sleep", 500]
      ]
    ]
  ]
}
